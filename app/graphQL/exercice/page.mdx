---
description: "Lâ€™objectif de cet exercice est de crÃ©er un serveur GraphQL simple qui permet de : 1. RÃ©cupÃ©rer des donnÃ©es via des requÃªtes (Query). 2. Modifier des donnÃ©es avec des mutations (Mutation). 3. Tester les interactions en utilisant un client GraphQL comme GraphiQL ou Apollo Explorer."
---
# **ğŸ“ Exercice Pratique : Mise en place dâ€™un serveur GraphQL simple**

Lâ€™objectif de cet exercice est de crÃ©er un serveur GraphQL simple qui permet de :
1. RÃ©cupÃ©rer des donnÃ©es via des **requÃªtes (Query)**.
2. Modifier des donnÃ©es avec des **mutations (Mutation)**.
3. Tester les interactions en utilisant un client GraphQL comme **GraphiQL** ou **Apollo Explorer**.

## ğŸ§¬ **PrÃ©requis**
- **Node.js** installÃ© sur votre machine.
- Un Ã©diteur de code comme Visual Studio Code.
- Les dÃ©pendances nÃ©cessaires : `npm install @apollo/server graphql`.

---

## ğŸ§¬ **Ã‰tape 1 : Structure du projet**

CrÃ©ez un rÃ©pertoire et initialisez un projet Node.js :
```bash copy
mkdir exercice-graphql
cd exercice-graphql
npm init -y
```

Installez les dÃ©pendances nÃ©cessaires :
```bash copy
npm install @apollo/server graphql
```

---

## ğŸ§¬ **Ã‰tape 2 : CrÃ©ation du serveur GraphQL**

CrÃ©ez un fichier principal `index.js` et ajoutez le code suivant :

### ğŸ§± **DÃ©finir le schÃ©ma**
Nous allons crÃ©er un schÃ©ma pour gÃ©rer une liste dâ€™Ã©tudiants, avec des propriÃ©tÃ©s comme `id`, `name`, et `email`.
```javascript copy
const { ApolloServer } = require('@apollo/server');
const { startStandaloneServer } = require('@apollo/server/standalone');

// DÃ©finition du schÃ©ma
const typeDefs = `
  type Student {
    id: ID!
    name: String!
    email: String!
  }

  type Query {
    students: [Student]
    student(id: ID!): Student
  }

  type Mutation {
    addStudent(name: String!, email: String!): Student
  }
`;

// DonnÃ©es simulÃ©es
const students = [
  { id: '1', name: 'Alice', email: 'alice@example.com' },
  { id: '2', name: 'Bob', email: 'bob@example.com' },
];

// Resolvers : Fournissent la logique pour les requÃªtes et mutations
const resolvers = {
  Query: {
    students: () => students,
    student: (_, { id }) => students.find(student => student.id === id),
  },
  Mutation: {
    addStudent: (_, { name, email }) => {
      const newStudent = {
        id: String(students.length + 1),
        name,
        email,
      };
      students.push(newStudent);
      return newStudent;
    },
  },
};

// CrÃ©ation du serveur Apollo
const server = new ApolloServer({ typeDefs, resolvers });
```

### ğŸ§¬ **DÃ©marrer le serveur**
Ajoutez la configuration pour dÃ©marrer le serveur sur un port donnÃ© :
```javascript copy
startStandaloneServer(server, {
  listen: { port: 4000 },
}).then(({ url }) => {
  console.log(`ğŸš€ Serveur prÃªt Ã  l'adresse : ${url}`);
});
```

---

## ğŸ§¬ **Ã‰tape 3 : Lancer et tester le serveur**

1. DÃ©marrez le serveur GraphQL :
   ```bash copy
   node index.js
   ```
   Vous devriez voir :
   ```
   ğŸš€ Serveur prÃªt Ã  l'adresse : http://localhost:4000/
   ```

2. Ouvrez lâ€™URL dans un navigateur ou un client comme **GraphiQL** ou **Apollo Studio Explorer**.

---

## ğŸ§¬ **Ã‰tape 4 : Tester les requÃªtes et mutations**

### ğŸ§¬ **RequÃªte pour rÃ©cupÃ©rer tous les Ã©tudiants**
```graphql copy
query {
  students {
    id
    name
    email
  }
}
```

**RÃ©ponse attendue :**
```json copy
{
  "data": {
    "students": [
      {
        "id": "1",
        "name": "Alice",
        "email": "alice@example.com"
      },
      {
        "id": "2",
        "name": "Bob",
        "email": "bob@example.com"
      }
    ]
  }
}
```

### ğŸ§¬ **RequÃªte pour rÃ©cupÃ©rer un Ã©tudiant spÃ©cifique**
```graphql copy
query {
  student(id: "1") {
    name
    email
  }
}
```

**RÃ©ponse attendue :**
```json copy
{
  "data": {
    "student": {
      "name": "Alice",
      "email": "alice@example.com"
    }
  }
}
```

### ğŸ§¬ **Mutation pour ajouter un Ã©tudiant**
```graphql copy
mutation {
  addStudent(name: "Charlie", email: "charlie@example.com") {
    id
    name
    email
  }
}
```

**RÃ©ponse attendue :**
```json copy
{
  "data": {
    "addStudent": {
      "id": "3",
      "name": "Charlie",
      "email": "charlie@example.com"
    }
  }
}
```

Refaites une requÃªte pour tous les Ã©tudiants et vÃ©rifiez que le nouvel Ã©tudiant a bien Ã©tÃ© ajoutÃ©.

---

## ğŸ§ª **Ã‰tape 5 : Ã‰tendre lâ€™exercice (facultatif)**

1. **Ajouter des relations** : Associez des Ã©tudiants Ã  des cours (par exemple, type `Course`).
2. **Pagination** : ImplÃ©mentez un systÃ¨me pour retourner les Ã©tudiants par page (par exemple, `limit` et `offset`).
3. **Validation** : Ajoutez des vÃ©rifications sur les champs envoyÃ©s dans les mutations (par exemple, vÃ©rifier que lâ€™email est valide).
4. **SÃ©curisation** : ImplÃ©mentez une logique de permissions pour restreindre l'accÃ¨s Ã  certaines donnÃ©es.

---

### ğŸ§¾ **RÃ©sumÃ© des objectifs atteints**

| **Objectif**                  | **Statut**                  |
|-------------------------------|----------------------------|
| Mettre en place un serveur    | âœ…                        |
| RÃ©cupÃ©rer des donnÃ©es (Query) | âœ…                        |
| Modifier des donnÃ©es (Mutation)| âœ…                       |
| Tester avec un client         | âœ…                        |

Cet exercice fournit une base solide pour comprendre et manipuler GraphQL. Vous pouvez lâ€™Ã©tendre en fonction des besoins spÃ©cifiques de vos projets.