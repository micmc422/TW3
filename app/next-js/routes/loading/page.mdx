# ğŸš€ **Utilisation des Loading States (`loading.tsx`) dans Next.js**  

L'App Router de Next.js permet d'afficher des **Ã©tats de chargement** (`loading.tsx`) de maniÃ¨re **native et optimisÃ©e**, sans avoir besoin de gÃ©rer manuellement un `useState` ou `useEffect` cÃ´tÃ© client.  

---

## **1ï¸âƒ£ Qu'est-ce que `loading.tsx` ?**  

ğŸ“Œ `loading.tsx` est un **React Server Component** utilisÃ© pour afficher un **squelette de chargement** pendant que les donnÃ©es de la page sont en cours de rÃ©cupÃ©ration.  
ğŸ“Œ Il est utile pour les pages qui chargent des donnÃ©es via des **fetch cÃ´tÃ© serveur** (`async/await`).  
ğŸ“Œ Il est **automatiquement affichÃ©** lorsqu'une page est en attente de donnÃ©es !  

---

## **2ï¸âƒ£ Exemple simple dâ€™un `loading.tsx` global**  

ğŸ“ **Ajout dâ€™un Ã©tat de chargement global pour toutes les pages**  

```tsx filename="app/loading.tsx" copy
export default function Loading() {
  return (
    <div className="flex items-center justify-center h-screen">
      <p className="text-lg font-semibold">Chargement en cours...</p>
    </div>
  );
}
```
ğŸ’¡ **Ce composant est automatiquement affichÃ©** lorsque **n'importe quelle page** met du temps Ã  charger.  

---

## **3ï¸âƒ£ Exemple : Loading spÃ©cifique pour une section (`dashboard/loading.tsx`)**  

ğŸ“ **Ajout dâ€™un Ã©tat de chargement uniquement pour `/dashboard`**  

```tsx filename="app/dashboard/loading.tsx" copy
export default function DashboardLoading() {
  return (
    <div className="flex flex-col items-center justify-center h-screen">
      <p className="text-lg font-semibold">Chargement du tableau de bord...</p>
      <div className="animate-spin rounded-full border-t-4 border-blue-500 border-solid h-12 w-12"></div>
    </div>
  );
}
```
ğŸ’¡ **Ce composant sâ€™affichera uniquement lors du chargement des pages dans `/dashboard`**.  

---

## **4ï¸âƒ£ DÃ©monstration avec une page utilisant un `fetch` cÃ´tÃ© serveur**  

ğŸ“ **CrÃ©ons une page qui charge des donnÃ©es avec un dÃ©lai artificiel**  

```tsx filename="app/dashboard/page.tsx" copy
async function fetchData() {
  await new Promise((resolve) => setTimeout(resolve, 2000)); // Simule un dÃ©lai
  return { message: "DonnÃ©es chargÃ©es avec succÃ¨s !" };
}

export default async function DashboardPage() {
  const data = await fetchData();

  return (
    <div>
      <h1 className="text-2xl font-bold">Tableau de bord</h1>
      <p>{data.message}</p>
    </div>
  );
}
```
ğŸ“ **Lorsqu'un utilisateur accÃ¨de Ã  `/dashboard` :**  
1ï¸âƒ£ **Le fichier `loading.tsx` s'affiche** immÃ©diatement.  
2ï¸âƒ£ **AprÃ¨s 2 secondes, les donnÃ©es sont affichÃ©es** sur la page.  

---

## **5ï¸âƒ£ DiffÃ©rence avec un `useState` cÃ´tÃ© client ?**  

| **MÃ©thode** | âœ… **`loading.tsx` (Server)** | âŒ `useState` (Client) |
|------------|-----------------------------|------------------------|
| Gestion automatique du state | âœ… Oui | âŒ Non |
| OptimisÃ© pour le SSR | âœ… Oui | âŒ Non |
| Bloque le rendu cÃ´tÃ© serveur | âœ… Oui | âŒ Non |
| Besoin de gÃ©rer `useState` / `useEffect` | âŒ Non | âœ… Oui |

ğŸ’¡ **Avec `loading.tsx`, plus besoin de gÃ©rer manuellement des loaders cÃ´tÃ© client !**  

---

## **ğŸ¯ Conclusion : Pourquoi utiliser `loading.tsx` ?**  

âœ” **Plus simple** â†’ Pas besoin de gÃ©rer `useState` et `useEffect`.  
âœ” **Plus rapide** â†’ IntÃ©grÃ© directement dans le Server Rendering.  
âœ” **Meilleure UX** â†’ Evite les pages blanches lors du chargement des donnÃ©es.  