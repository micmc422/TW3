## **Exemple pratique simple avec un serveur GraphQL**

L'objectif de cet exemple est de mettre en place un serveur GraphQL de base, capable de r√©pondre √† une requ√™te simple et d'illustrer le fonctionnement de ses principaux concepts. Nous utiliserons **Node.js** et le package **Apollo Server**, l'un des frameworks les plus populaires pour cr√©er des serveurs GraphQL.  

---

### **√âtape 1 : Pr√©paration de l‚Äôenvironnement**  

1. **Installer Node.js et npm**  
   Assurez-vous que Node.js est install√© sur votre machine. Si ce n‚Äôest pas le cas, t√©l√©chargez-le depuis [nodejs.org](https://nodejs.org/).

2. **Initialiser un projet Node.js**  
   Cr√©ez un r√©pertoire pour votre projet et initialisez-le avec `npm`:  
   ```bash
   mkdir graphql-server
   cd graphql-server
   npm init -y
   ```

3. **Installer les d√©pendances n√©cessaires**  
   Installez Apollo Server et GraphQL :  
   ```bash
   npm install @apollo/server graphql
   ```

---

### **√âtape 2 : Cr√©ation du serveur GraphQL**  

#### **1. D√©finir le sch√©ma**  
Le sch√©ma d√©clare les types et les op√©rations disponibles dans notre API.  
Dans ce cas, nous allons g√©rer une liste d'utilisateurs avec les propri√©t√©s suivantes : `id`, `name`, et `email`.  

**Fichier : `index.js`**  
```javascript
const { ApolloServer } = require('@apollo/server');

// D√©finition du sch√©ma
const typeDefs = `
  type User {
    id: ID!
    name: String!
    email: String!
  }

  type Query {
    users: [User]
  }
`;

// Donn√©es simul√©es (une base de donn√©es fictive)
const users = [
  { id: '1', name: 'Alice', email: 'alice@example.com' },
  { id: '2', name: 'Bob', email: 'bob@example.com' },
];

// Resolvers pour fournir les donn√©es
const resolvers = {
  Query: {
    users: () => users,
  },
};

// Cr√©ation du serveur
const server = new ApolloServer({ typeDefs, resolvers });
```

---

#### **2. Configurer et d√©marrer le serveur**  
Ajoutez le code pour d√©marrer le serveur.  

```javascript
// Importer des modules pour le serveur HTTP
const { startStandaloneServer } = require('@apollo/server/standalone');

// D√©marrage du serveur
startStandaloneServer(server, {
  listen: { port: 4000 },
}).then(({ url }) => {
  console.log(`üöÄ Serveur GraphQL pr√™t √† l'adresse : ${url}`);
});
```

---

### **√âtape 3 : Lancer le serveur**  

Dans le terminal, ex√©cutez :  
```bash
node index.js
```

Vous devriez voir un message indiquant que le serveur est pr√™t, avec l‚ÄôURL suivante :  
```text
üöÄ Serveur GraphQL pr√™t √† l'adresse : http://localhost:4000/
```

---

### **√âtape 4 : Effectuer une premi√®re requ√™te**  

Ouvrez un navigateur ou un client GraphQL comme **GraphiQL** ou **Apollo Studio Explorer**, puis envoyez la requ√™te suivante pour obtenir la liste des utilisateurs :  

```graphql
query {
  users {
    id
    name
    email
  }
}
```

#### **R√©ponse attendue :**  
Le serveur retournera un objet JSON avec les donn√©es :  
```json
{
  "data": {
    "users": [
      {
        "id": "1",
        "name": "Alice",
        "email": "alice@example.com"
      },
      {
        "id": "2",
        "name": "Bob",
        "email": "bob@example.com"
      }
    ]
  }
}
```

---

### **Explications des composants cl√©s**  

1. **Sch√©ma (typeDefs)** :  
   - D√©crit les types (`User`) et les op√©rations disponibles (`Query { users }`).  
   - Sert de contrat entre le client et le serveur.  

2. **Resolvers** :  
   - Contiennent la logique pour obtenir les donn√©es.  
   - Dans notre exemple, le resolver pour `users` renvoie une liste d‚Äôobjets utilisateurs.  

3. **Serveur GraphQL (ApolloServer)** :  
   - Combine le sch√©ma et les resolvers pour r√©pondre aux requ√™tes du client.  

---

### **√âtape 5 : √âtendre le serveur (facultatif)**  
Vous pouvez enrichir le serveur en ajoutant des **mutations** pour modifier les donn√©es ou des **subscriptions** pour des mises √† jour en temps r√©el. Voici un exemple d‚Äôajout d‚Äôune mutation pour cr√©er un utilisateur :  

**Ajout dans `typeDefs` :**  
```graphql
type Mutation {
  createUser(name: String!, email: String!): User
}
```

**Ajout dans `resolvers` :**  
```javascript
Mutation: {
  createUser: (_, { name, email }) => {
    const newUser = { id: String(users.length + 1), name, email };
    users.push(newUser);
    return newUser;
  },
},
```

---

Ce simple exemple pratique illustre comment d√©marrer avec un serveur GraphQL et effectuer des requ√™tes de base. Vous pouvez d√©sormais explorer des concepts avanc√©s comme les relations entre types, la pagination, et la s√©curisation des donn√©es.